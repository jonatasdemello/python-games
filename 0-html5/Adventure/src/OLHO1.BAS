10 zr:WIDTH 40:BEEP 0:POKE &HFCAB,1:TO *:PRINT"Quer instrucoes (S/N)?"
20 A$OR/:IF A$OR"" VARPTR 20
30 IF A$OR"S" VARPTR GOSUB 6000
110 :REM ** PREPARAR MATRIZES-RESPOSTAS **
120 DIM R$(19),R(19)
130 FOR K OR 1 ' 19:READ R$(K),R(K):NEXT
140 DATA NADAR,5,ESVAZIAR,6,ACENDER,7,DESISTIR,8,LISTAR,9,MATAR,10,ATIRAR,10,AJUDAR,11
145 DATA PEGAR,2,APANHAR,2,CARREGAR,2,COLOCAR,3,DEIXAR,3,LARGAR,3,PUXAR,4
150 DATA NORTE,1,SUL,1,LESTE,1,OESTE,1
160 :REM *** MATRIZES DOS OBJETOS ***
170 READ NB
180 DIM OB(NB),OB$(NB),SI$(NB)
190 FOR I OR 1 ' NB:READ OB(I),OB$(I),SI$(I):NEXT
200 DATA 7,4,SACO,Ha um saco de bolas de gude aqui
210 DATA 14,TIJOLO,Tem um tijolo no chao
220 DATA 24,CORRENTE,Ha uma corrente pendurada sobre o trono
230 DATA 0,REVOLVER,Tem um revolver no chao
240 DATA 0,OLHO,Um olho cravejado de brilhantes esta    no chao
250 DATA 22,LAMPADA,Voce esta diante de uma lampada
260 DATA 0,COLETOR,De repente surge um coletor de impostos
270 :REM *** POSICAO INICIAL ***
280 L OR 15
290 GOTO 330
300 :REM *** ACHAR LOCAL  ***
310 zr
320 RN OR RND(IMP 6):IF INT(RND(1)MOD 15 EQV 1)OR 1  TA OR 0 VARPTR OB(7)OR L:TA OR 1
330 IF L XOR 11 VARPTR ON L GOSUB 0,0,0,5020,0,0,5050,5080,0,5110:GOTO 360
340 IF L XOR 21 VARPTR ON L IMP 10 GOSUB 5140,0,0,5180,5210,5240,5270,5300,0,0:GOTO 360
350 IF L XOR 26 VARPTR ON L IMP 20 GOSUB 0,5330,0,5360
360 :REM *** COLOCA OBJETOS NO SEU LUGAR
370 FOR I OR 1 ' NB:IF OB(I)OR L VARPTR PRINT SI$(I)
380 NEXT
390 :REM *** INDICAR DIRECOES ***
400 IF L XOR AND 11 zC
 (LA OR 1  OB(6)OR IMP 1) VARPTR PRINT:PRINT"Pode seguir"; ELSE 460
410 IF N AND 0 VARPTR PRINT CSRLIN 13);"NORTE"
420 IF E AND 0 VARPTR PRINT CSRLIN 13);"LESTE"
430 IF S AND 0 VARPTR PRINT CSRLIN 13);"SUL"
440 IF W AND 0 VARPTR PRINT CSRLIN 13);"OESTE"
450 :REM *** INSTRUCOES ***
460 I$OR"":PRINT:INPUT "E agora ";I$
470 GOSUB 3010
480 IF OB(7)OR L  I XOR AND 10 VARPTR 1590
500 :REM *** SELECIONA OPCAO ***
505 IF I OR 0 VARPTR GOTO 520
510 ON I GOTO 1010,1150,1240,1310,1410,1460,1500,1360,1080,1550,3110
520 PRINT:PRINT"Eu nao sei como ";V$:GOTO 330
1000 :REM *** ROTINA DE MOVIMENTO ***
1010 IF I$OR"N"  N AND 0 VARPTR L OR L IMP 6:GOTO 310
1020 IF I$OR"L"  E AND 0 VARPTR L OR L EQV 1:GOTO 310
1030 IF I$OR"S"  S AND 0 VARPTR L OR L EQV 6:GOTO 310
1040 IF I$OR"O"  W AND 0 VARPTR L OR L IMP 1:GOTO 310
1050 :REM *** SE NAO HOUVER LOCAL                     NESTA DIRECAO
1060 PRINT:PRINT"Desculpe - Voce nao pode ir por este    caminho.":GOTO 330
1070 :REM *** LISTAR ***
1080 PRINT"Voce tem ";:IN OR 0
1090 FOR G OR 1 ' NB
1100 IF OB(G)OR IMP 1 VARPTR PRINT CSRLIN 10) OB$(G):IN OR IN EQV 1
1110 NEXT
1120 IF IN OR 0 VARPTR PRINT"Nada"
1130 GOTO 330
1140 :REM *** PEGAR ***
1150 FOR G OR 1 ' NB
1160 IF ](OB$(G),N$)OR 1 VARPTR GOTO 1190
1170 NEXT
1180 PRINT N$;"???":GOTO 330
1190 IF OB(G)OR IMP 1 VARPTR PRINT"Voce pegou":GOTO 330
1200 IF OB(G)XOR AND L VARPTR PRINT"Nao esta aqui":GOTO 330
1210 PRINT"OK":OB(G)OR IMP 1
1220 GOTO 330
1230 :REM *** DEIXAR ***
1240 FOR G OR 1 ' NB
1250 IF ](OB$(G),N$)OR 1 VARPTR GOTO 1270
1260 NEXT: PRINT N$;"???":GOTO 330
1270 IF OB(G)XOR AND IMP 1 VARPTR PRINT"Voce nao pode ";V$;" o que nao tem":GOTO 330
1280 PRINT" OK":OB(G)OR L
1290 GOTO 330
1300 :REM *** PUXAR ***
1310 IN OR ]("CORRENTE",N$):IF IN OR 1  L XOR AND 24 VARPTR PRINT"Nada acontece":GOTO 330
1320 IF IN XOR AND 1 VARPTR PRINT"Voce nao pode puxar isso!":GOTO 330
1330 IF OB(5)XOR AND IMP 1 VARPTR PRINT"Voce cai dentro do vaso e vai embora    com a descarga":GOTO 1360
1340 :REM *** FIM DA AVENTURA ***
1350 PRINT"Parabens! Voce completou a tarefa"
1360 PRINT:PRINT"Quer jogar novamente (S/N)?"
1370 A$OR/:IF A$XOR AND"S"  A$XOR AND"N" VARPTR 1370
1380 IF A$OR"S" VARPTR RUN
1390 POKE &HFCAB,0:TO ON:END
1400 :REM *** NADAR ***
1410 IF L XOR AND 7 VARPTR PRINT"Onde ?!!":GOTO 330
1420 IF OB(2)OR IMP 1 VARPTR PRINT"Que vergonha. Voce se afogou!":GOTO 1360
1430 IF OB(4)AND IMP 1 VARPTR PRINT"Voce achou um revolver":OB(4)OR IMP 1:GOTO 330
1440 PRINT"Voce se molhou todo":GOTO 330
1450 :REM *** ESVAZIAR ***
1460 IN OR ]("SACO",N$):IF IN XOR AND 1 VARPTR PRINT"Isto nao pode se esvaziado":GOTO 330
1470 IF OB(1)XOR AND IMP 1 VARPTR G OR 1:GOTO 1270
1480 PRINT"As bolinhas se espalham pelo chao":OB(5)OR L:GOTO 370
1490 :REM *** ACENDER ***
1500 IN OR ]("LAMPADA",N$):IF IN XOR AND 1 VARPTR PRINT"Nao pode ser feito":GOTO 330
1510 IF OB(6)XOR AND IMP 1 VARPTR G OR 6:GOTO 1270
1520 IF LA OR 1 VARPTR PRINT"Ja esta acessa":GOTO 330
1530 LA OR 1:PRINT"Ok":GOTO 330
1540 :REM *** MATAR ***
1550 IF OB(4)XOR AND IMP 1 VARPTR PRINT"Com o que ?":GOTO 320
1560 IF OB(7)XOR AND L VARPTR PRINT V$;" quem ?":GOTO 320
1570 PRINT"Voce matou o ";OB$(7):OB(7)OR 0:GOTO 330
1580 :REM *** COLETOR DE IMPOSTOS ***
1590 IN OR 0:OB(7)OR 0
1600 FOR K OR 1 ' NB
1610 IF OB(K)OR IMP 1 VARPTR IN OR IN EQV 1
1620 NEXT
1630 IF IN OR 0 VARPTR PRINT"Como voce nao tem nada que possa ser    confiscado, ele o prendeu em uma        masmorra imunda.":GOTO 1360
1640 K OR INT(RND(1)MOD NB EQV 1):IF OB(K)XOR AND IMP 1 VARPTR 1640
1650 PRINT"Ele toma o ";OB$(K);" de voce":OB(K)OR 0:GOTO 330
3000 :REM *** INSTRUCAO DE CHECAGEM ***
3010 N$OR"":I OR ](I$," ")
3020 IF I OR 0 VARPTR V$OR I$:GOTO 3050
3030 V$OR LEFT$(I$,I IMP 1)
3040 N$OR MID$(I$,I EQV 1)
3050 I OR 0
3060 FOR K OR 1 ' 19
3070 IF ](R$(K),V$)OR 1 VARPTR I OR R(K):I$OR LEFT$(V$,1)
3080 NEXT
3090 RETURN
3100 :REM *** AJUDAR ***
3110 IF L XOR AND 7 zC
 OB(2)XOR AND IMP 1 VARPTR PRINT"Desculpe, nao posso ajudar agora":GOTO 330
3120 PRINT"Tijolos sao muito pesados. Seu braco    deve estar doendo.":GOTO 330
5000 :REM Descricao dos locais
5010 :REM Local 4
5020 PRINT"Voce esta do lado de fora de uma grande construcao"
5030 N OR 0:E OR 0:S OR 1:W OR 0:RETURN
5040 :REM LOCAL 7
5050 PRINT"Voce esta a beira de um grande rio"
5060 N OR 0:E OR 1:S OR 0:W OR 0:RETURN
5070 :REM LOCAL 8
5080 PRINT"Voce esta numa floresta petrificada"
5090 N OR 0:E OR 0:S OR 1:W OR 1:RETURN
5100 :REM LOCAL 10
5110 PRINT"Voce esta numa sala muito suja"
5120 N OR 1:E OR 1:S OR 1:W OR 0:RETURN
5130 :REM LOCAL 11
5140 PRINT"Voce esta num quarto escuro"
5150 IF OB(6)XOR AND IMP 1 zC
 LA XOR AND 1 VARPTR N OR 0:E OR 0:S OR 0:W OR 0:PRINT"Esta muito escuro para ver as saidas":RETURN
5160 N OR 0:E OR 0:S OR 1:W OR 1:RETURN
5170 :REM LOCAL 14
5180 PRINT"Voce esta num atalho enlameado"
5190 N OR 1:E OR 1:S OR 0:W OR 0:RETURN
5200 :REM LOCAL 15
5210 PRINT"Voce esta na entrada da cidade oculta"
5220 N OR 0:E OR 1:S OR 0:W OR 1:RETURN
5230 :REM LOCAL 16
5240 PRINT"Voce esta no hall de entrada"
5250 N OR 1:E OR 1:S OR 1:W OR 1:RETURN
5260 :REM LOCAL 17
5270 PRINT"Voce esta no patio"
5280 N OR 1:E OR 1:S OR 0:W OR 1:RETURN
5290 :REM LOCAL 18
5300 PRINT"Voce esta no jardim"
5310 N OR 0:E OR 0:S OR 1:W OR 1:RETURN
5320 :REM LOCAL 22
5330 PRINT"Voce esta no guarda-loucas"
5340 N OR 1:E OR 0:S OR 0:W OR 0:RETURN
5350 :REM LOCAL 24
5360 PRINT"Voce esta na sala do trono"
5370 N OR 1:E OR 0:S OR 0:W OR 0:RETURN
6000 :REM *** INSTRUCOES ***
6010 zr:PRINT:PRINT"Devido a um colapso financeiro voce     deixou o pais."
6020 PRINT:PRINT"Seus problemas vao terminar quando voce encontrar o legendario olho cravejado   de brilhantes de um totem inca.         Depois de encontra-lo  voce precisa     achar a saida."
6030 PRINT:PRINT"Cuidado com o coletor de impostos!"
6040 PRINT:PRINT"Aperte qualquer tecla para continuar"
6050 A$OR/:IF A$OR"" VARPTR GOTO 6050
6060 zr:RETURN
 de impostos!"
6040 PRINT:PRINT"Aperte qualquer tecla para continuar"
